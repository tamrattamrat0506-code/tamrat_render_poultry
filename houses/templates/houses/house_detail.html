{% extends 'base/base.html' %}
{% load i18n %}
{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'houses/css/house_detail.css' %}">
{% endblock %}

{% block content %}
<div class="house-detail-container">
    <!-- Main Content -->
    <div class="house-content">
        <div class="image-gallery">
            <div class="main-image">
                <img id="mainHouseImage" src="{{ house.images.all.0.image.url }}" alt="Main House Image" />
                <span class="carted-badge {% if house.is_carted %}carted{% endif %}">
                    <i class="fas fa-shopping-cart"></i>
                </span>
            </div>
            <div class="thumbnail-list">
                {% for image in house.images.all %}
                    <img class="thumbnail" src="{{ image.image.url }}" alt="House Image" loading="lazy">
                {% endfor %}
            </div>
            <div class="interaction-buttons">
                    <button type="button" 
                            class="interaction-button like-button"
                            aria-label="{% trans 'Like this house' %}"
                            data-item-id="{{ house.id }}"
                            data-action="like">
                        <i class="fas fa-thumbs-up" aria-hidden="true"></i> 
                        <span class="interaction-count" id="like-count" aria-live="polite">{{ house.like_count }}</span>
                    </button>
                    
                    <button type="button" 
                            class="interaction-button share-button"
                            aria-label="{% trans 'Share this house' %}"
                            data-item-id="{{ house.id }}"
                            data-action="share"> 
                        <i class="fas fa-share-alt" aria-hidden="true"></i> 
                        <span class="interaction-count" id="share-count" aria-live="polite">{{ house.share_count }}</span>
                    </button>
                </div>
        </div>

        <!-- House Information -->
        <div class="house-info">
            <h1>{{ house.title }}</h1>
            <p class="price">${{ house.price }}</p>
            <p class="location"><strong>{% trans "Location:" %}</strong> {{ house.city }}, {{ house.state }}</p>
            <p class="category"><strong>{% trans "Category:" %}</strong> {{ house.get_category_display }}</p>

            <p class="description">{{ house.description}}</p>

            <ul class="features">
                <li><strong>{% trans "Bedrooms:" %}</strong> {{ house.bedrooms }}</li>
                <li><strong>{% trans "Bathrooms:" %}</strong> {{ house.bathrooms }}</li>
                <li><strong>{% trans "Area:" %}</strong> {{ house.area }} {% trans "sq.m" %}</li>
            </ul>

            <!-- Action Buttons -->
            <div class="action-buttons">
                
                {% if house.created_by %}
    <div class="seller-section">
        <a href="{% url 'users:seller_profile' house.created_by.id %}" class="seller-link">
            {% if house.created_by.profile.profile_picture %}
                <img src="{{ house.created_by.profile.profile_picture.url }}" 
                     alt="{{ house.created_by.username }}'s profile picture" 
                     class="seller-avatar" width="60" height="60" loading="lazy">
            {% else %}
                <div class="seller-avatar default-avatar"><i class="fas fa-user-circle"></i></div>
            {% endif %}
        </a>
        <div class="seller-info">
            <h2 id="seller-heading" class="seller-name">
                {{ house.created_by.profile.user_name|default:house.created_by.phone_number }}
            </h2>
            <span class="seller-label">{% trans "Seller" %}</span>
        </div>
    </div>
    {% endif %}
                <a href="{% url 'cart:add_to_cart' app_label model_name house.id %}" class="add-to-cart-btn"><i class="fas fa-shopping-cart"></i> 
                    {% trans "Add to Cart" %}
                </a>
                
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block js %}
<script defer src="{% static 'houses/js/house_detail.js' %}"></script>
{% endblock %}